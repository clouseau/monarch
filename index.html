<!DOCTYPE html>
<html>
	<head>
		<title>Monarch Quiz</title>
		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
		<link rel="stylesheet" href="libs/bootstrap-3.3.5-dist/css/bootstrap.min.css">
		<style type="text/css">
		.col-centered {
			float: none;
			margin: 0 auto;
		}

		.row-centered {
			margin: auto;
			position: absolute;
			top: 0; right: 0; bottom: 0; left: 0;
		}

		a.thumbnail {
			transition: none;
		}

		a.thumbnail .thumbnail-label {
		  position: absolute;
		  top: 0;
		  bottom: 0;
		  margin: auto;
		  height: 50px;
		  left: 0;
		  right: 0;
		  width: 80%;
		  color: #000;
		  font-weight: bold;
		  font-size: 24px;
		  text-align: center;
		}

		a.thumbnail .thumbnail-label label {
			vertical-align: middle;
			line-height: normal;
		}

		.answered-right a.thumbnail,
		.answered-right a.thumbnail.active, .answered-right a.thumbnail:focus {
			outline: 6px solid #5cb85c !important;
		}

		.answered-wrong a.thumbnail,
		.answered-wrong a.thumbnail.active,
		.answered-wrong a.thumbnail:focus {
			outline: 6px solid #d9534f !important;
		}

		.answered-wrong a.thumbnail img,
		.answered-wrong a.thumbnail.active img,
		.answered-wrong a.thumbnail:focus img {
			opacity: 0.2;
		}

		* {
	    -webkit-touch-callout:none;
	    -webkit-user-select:none;
	    -moz-user-select:none;
	    -ms-user-select:none;
	    user-select:none;
		}

		a:hover, a:active, a:focus,
		button:hover, button:active, button:focus {
		  outline: 0 !important;
		}

		.btn-group-xl>.btn, .btn-xl {
			padding: 16px 22px;
			font-size: 26px;
		}

		.quiz {
			margin-top: 40px;
		}

		.panel.panel-default {
			border-color: transparent;
			box-shadow: none;
		}
		</style>
		<script type="text/javascript" src="libs/angular-1.3.16/angular.min.js"></script>
		<script type="text/javascript">
		angular.module('app',[])

		.constant('QUESTIONS', [{
				text: "Which is the monarch butterfly?",
				options: [{
					type: "Butterfly",
					answer: true,
					url: "images/Q1 Monarch William Ciesla.jpg",
					text: "Monarch"
				}, {
					type: "Fly",
					answer: false,
					url: "images/Q1 Regal Fritillary Richard Stilwell.jpg",
					text: "Regal Fritillary"
				}, {
					type: "Butterfly",
					answer: false,
					url: "images/Q1 Tiger swallowtail  Edward L. Manigault.jpg",
					text: "Tiger swallowtail"
				}, {
					type: "Rabbit",
					answer: false,
					url: "images/Q1 Viceroy  Jerry A Payne.jpg",
					text: "Viceroy"
				}]
			}, {
				text: "On which plant does the monarch butterfly lay her eggs?",
				options: [{
					type: "Butterfly",
					answer: false,
					url: "images/Q2 Dogbane Chris Evans.jpg",
					text: "Dogbane"
				}, {
					type: "Fly",
					answer: false,
					url: "images/Q2 Queen Anne's Lace Chris Evans.jpg",
					text: "Queen Anne's Lace"
				}, {
					type: "Butterfly",
					answer: false,
					url: "images/Q2 Wild rose William Ciesla.jpg",
					text: "Wild rose"
				}, {
					type: "Rabbit",
					answer: true,
					url: "images/Q2 Milkweed hartzler.jpg",
					text: "Milkweed hartzler"
				}]
			}, {
				text: "Which is the monarch butterfly caterpillar?",
				options: [{
					type: "Butterfly",
					answer: true,
					url: "images/Q3  Monarch caterpillar Sturgis McKeever.jpg",
					text: "Monarch caterpillar"
				}, {
					type: "Fly",
					answer: false,
					url: "images/Q3  tomato hornworm Whitney Cranshaw.jpg",
					text: "Tomato hornworm"
				}, {
					type: "Butterfly",
					answer: false,
					url: "images/Q3  Woollybear Whitney Cranshaw.jpg",
					text: "Woollybear"
				}, {
					type: "Rabbit",
					answer: false,
					url: "images/Q3 Black swallowtail caterpillar Phil Sloderbeck.jpg",
					text: "Black swallowtail caterpillar"
				}]
			}, {
				text: "In which does the monarch caterpillar change to the butterfly?",
				options: [{
					type: "Butterfly",
					answer: false,
					url: "images/Q4 Celeryworm chrysalis Whitney Cranshaw.jpg",
					text: "Celeryworm chrysalis"
				}, {
					type: "Fly",
					answer: false,
					url: "images/Q4 Hornworm Pupa Nancy Hinkle.jpg",
					text: "Hornworm pupa"
				}, {
					type: "Butterfly",
					answer: true,
					url: "images/Q4 Monarch Chrysalis Whitney Cranshaw.jpg",
					text: "Monarch chrysalis"
				}, {
					type: "Rabbit",
					answer: false,
					url: "images/Q4 Cecropia cocoon.jpg",
					text: "Cecropia cocoon"
				}]
			}, {
				text: "How has the numbar of monarchs changed in the past 20 years?",
				options: [{
					type: "Butterfly",
					answer: false,
					url: "images/Q5 Unchanged.JPG",
					text: "Unchanged"
				}, {
					type: "Fly",
					answer: true,
					url: "images/Q5 Collapse.JPG"
				}, {
					type: "Butterfly",
					answer: false,
					url: "images/Q5 Increase.JPG",
					text: "Increase"
				}, {
					type: "Rabbit",
					answer: false,
					url: "images/Q5 Decrease.JPG",
					text: "Decrease"
				}]
			}
		])

		.constant('APP_STATES', {
			START: 0,
			QUESTIONS: 1,
			END: 2
		})

		.directive('questionnaire',['$timeout', 'QUESTIONS', 'APP_STATES', function($timeout, QUESTIONS, APP_STATES) {
			return {
				link: function(scope, element, attrs) {
					function init() {
						scope.app = {
							state: APP_STATES.START,
							questionnaire: {
								next: false,
								finish: false
							}
						};

						// We want to use a copy, not the original.
						// That way we can start new questionnaires
						// over and over again using the original data.
						scope.questions = angular.copy(QUESTIONS);

						// Index for the current question
						scope.currentQuestion = 0;
					}

					scope.nextState = function(state) {
						scope.app.state = state;
					};

					scope.nextQuestion = function() {
						scope.currentQuestion++;
						scope.app.questionnaire.next = false;
					};

					scope.answer = function(i) {
						scope.questions[scope.currentQuestion].options[i].answered = true;
						if(scope.questions[scope.currentQuestion].options[i].answer) {
							// Correct!
							// Move to next question
							if(scope.currentQuestion + 1 in scope.questions) {
								// There is a next question
								// Show 'Next' button
								scope.app.questionnaire.next = true;
							} else {
								// This is the last question
								scope.app.questionnaire.finish = true;
							}
						} else {
							// Not correct!
						}
					};

					scope.finish = function() {
						scope.app.state = APP_STATES.END;
					};

					scope.restart = function() {
						init();
					};

					init();
				}
			};
		}])

		.directive('preLoad', ['$timeout', 'QUESTIONS', function($timeout, QUESTIONS) {
			return {
				link: function() {
					$timeout(function() {
						QUESTIONS.forEach(function(e) {
							e.options.forEach(function(o) {
								new Image().src = o.url;
							});
						});
					}, 0);
				}
			};
		}]);
		</script>
	</head>
	<body ng-app="app" questionnaire pre-load>
		<div ng-switch on="app.state" class="container-fluid">
			<div ng-switch-when="0">
				<div class="row">
					<div class="col-xs-10 col-xs-8 col-md-4 col-centered row-centered text-center" style="height: 300px;">
						<h1>Monarch Quiz</h1>
						<h4>How well do you know the monarch butterfly?</h4>
						<button type="button" class="btn btn-success btn-xl" ng-mousedown="nextState(1)">Start</button> 
					</div>
				</div>
			</div>
			<div ng-switch-when="1" ng-cloak class="quiz">
				<div class="row">
					<div class="col-xs-12 col-xs-12 col-md-12 col-centered text-center" style="height: 500px;">
						<div class="col-xs-12 col-sm-8 col-md-6 col-centered">
							<div class="progress row">
							  <div class="progress-bar progress-bar-info" role="progressbar" aria-valuenow="{{ currentQuestion / questions.length }}" aria-valuemin="0" aria-valuemax="100" ng-style="{'width': (currentQuestion / questions.length * 100) + '%'}">
							    <span class="sr-only">20% Complete</span>
							  </div>
							</div>
						</div>
						<div class="panel panel-default">
							<div class="panel-body">
								<div class="question">
									<h1>{{ questions[currentQuestion].text }}</h1>
									<br><br>
									<div class="row">
										<div class="col-xs-12 col-sm-4 col-md-3" ng-repeat="opt in questions[currentQuestion].options" ng-class="{'answered-right':opt.answered && opt.answer, 'answered-wrong':opt.answered && !opt.answer}">
											<a href class="thumbnail" ng-mousedown="answer($index)" draggable="false" style="min-height:100px">
												<img src="{{ opt.url }}" alt width="auto" height="200px" draggable="false">
												<div class="thumbnail-label"><label ng-if="opt.answered">{{ opt.text }}</label></div>
											</a>
										</div>
									</div>
								</div>
								<br><br>
								<div class="controls clearfix">
									<ul class="list-inline list-unstyled pull-right">
										<li><button type="button" class="btn btn-primary btn-xl" ng-if="app.questionnaire.next" ng-mousedown="nextQuestion()">Next Question</button></li>
										<li><button type="button" class="btn btn-primary btn-xl" ng-if="app.questionnaire.finish" ng-mousedown="finish()">Finish</button></li>
									</ul>
								</div>
							</div>
						</div>
						<button type="button" class="btn btn-link btn-xl col-centered" ng-mousedown="restart()">Start Over</button>
					</div>
				</div>
			</div>
			<div ng-switch-when="2" ng-cloak>
				<div class="row">
					<div class="col-xs-10 col-xs-8 col-md-4 col-centered row-centered text-center" style="height: 300px;">
						<h1>Congratulations!</h1>
						<h2>You're a winner!</h2>
						<button type="button" class="btn btn-success btn-xl" ng-mousedown="restart()">Restart</button> 
					</div>
				</div>
			</div>
		</div>
		<script type="text/javascript" src="libs/fastclick-1.0.6/fastclick.js"></script>
		<script type="text/javascript">
		if ('addEventListener' in document) {
	    document.addEventListener('DOMContentLoaded', function() {
        FastClick.attach(document.body);
	    }, false);
		}
		</script>
	</body>
</html>